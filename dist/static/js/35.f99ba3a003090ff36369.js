webpackJsonp([35],{204:function(e,t,n){"use strict";(function(e){function r(e,t,n){layer.msg(e||"操作成功！",{time:t||1e3},function(){n&&n()})}function o(e,t,n){return layer.open({style:"background-color:rgba(0,0,0,0.8);color:white;max-width:70%;width:auto;border-radius: 4px;",shade:"background-color: rgba(0,0,0,0)",content:e||"error",time:t||2e3,end:function(){n&&n()}})}function a(t){return t.hideLayer=void 0==t.hideLayer||t.hideLayer,e.cookie("_token_")?t.headers={Authorization:"Bearer "+e.cookie("_token_")}:t.headers={},new _.a(function(n,a){var s="?";t.url.indexOf("?")>-1&&(s="&"),e.ajax({type:t.type||"post",url:"/"+t.url+(t.cache?"":s+"random="+Math.random()),cache:t.cache||!1,dataType:t.dataType||"json",beforeSend:function(n){t.isLogin||n.setRequestHeader("Authorization","Bearer "+e.cookie("_token_"))},contentType:t.content_type||"application/json",timeout:t.timeout||1e4,async:void 0==t.async||t.async,data:t.data||{},headers:t.headers,complete:function(){t.noHideLoading||layer.closeAll("loading")},success:function(e){t.noHideLoading||layer.closeAll("loading"),e&&(e.error_code||""==e.error_code)?a(e):n(e)},error:function(e,n,s){if(t.noHideLoading||layer.closeAll("loading"),t.hideLayer&&layer.closeAll(),"first"===t.is_failure)return void a(e);if("500"==e.status||"401"==e.status){var u=JSON.parse(e.responseText);"10000"==u.code?o("系统异常，请稍后再试！"):"20401"==u.code||"10007"==u.code?r("请重新登录！",null,function(){i()}):"invalid_token"==u.error?i():t.showFailure||o(u.message)}else{try{layer.close(f)}catch(e){}o("系统异常，请稍后再试！")}a(e)}})})}function i(){e.cookie("_id_","",{path:"/",expires:-1}),e.cookie("_un_","",{path:"/",expires:-1}),e.cookie("_ut_","",{path:"/",expires:-1}),e.cookie("_token_","",{path:"/",expires:-1}),window.sessionStorage.getItem("_transLogout_")?c():window.top.location.href=s()+"/user/html/login.html"}function s(){var t=void 0;try{t=window.top.location.href}catch(e){t=window.location.href}return u("platformUrl",t)||e.cookie("_platformUrl_")}function u(e,t){var n="",r=t||window.location.href;if(r.indexOf("?")>-1){var o=r.substring(r.indexOf("?")+1);if(e+="=",o.indexOf(e)>-1){var a=o.substr(o.indexOf(e)+e.length);-1!=a.indexOf("&")&&(a=a.substring(0,a.indexOf("&"))),n=a}}return decodeURIComponent(n)}function c(){var e=JSON.parse(window.sessionStorage.getItem("_transLogout_")),t=unescape(e.transPage),n=e.transLogoutFun;if("undefined"==typeof exec_obj){var r=document.createElement("iframe");r.id="transIframe",r.name="transIframe",r.src=t+"?transFun="+n,r.style.display="none",document.body.appendChild(r)}else exec_obj.src=t+"?transFun="+n+"&random="+Math.random();"function"==typeof parent.exec_iframe_login&&parent.exec_iframe_login()}function p(){return window.sessionStorage.getItem("_organCode_")||u("organCode")}function l(e){var t={year:"",month:"",day:"",age:""};if(!e)return t.year="adult",t.age="未知",t;e=e.replace(/个/g,"");var n=e.indexOf("岁"),r=e.indexOf("月"),o=e.indexOf("天"),a=e.substring(n+1,e.length),i=e.substring(r+1,e.length);return-1===n&&-1===r&&-1===o||n>-1&&-1===r&&-1===o&&!a?(t.year=n>-1?e.substring(0,n):e,t.age=t.year+"岁",t):n>-1&&r>-1&&-1===o&&!i||n>-1&&-1===r&&-1===o&&a?(t.year=e.substring(0,n),t.month=r>-1?e.substring(n+1,r):a,t.age=t.year+"岁"+t.month+"个月",t):n>-1&&-1===r&&o>-1?(t.year=e.substring(0,n),t.month="0",t.day=e.substring(n+1,o),t.age=t.year+"岁"+t.day+"天",t):n>-1&&r>-1&&o>-1||n>-1&&r>-1&&-1===o&&i?(t.year=e.substring(0,n),t.month=e.substring(n+1,r),t.day=o>-1?e.substring(r+1,o):i,t.age=t.year+"岁"+t.month+"个月"+t.day+"天",t):-1===n&&r>-1&&-1===o&&!i?(t.year="0",t.month=e.substring(0,r),t.age=t.month+"个月",t):-1===n&&r>-1&&o>-1||-1===n&&r>-1&&-1===o&&i?(t.year="0",t.month=e.substring(0,r),t.day=o>-1?e.substring(r+1,o):i,t.age=t.month+"个月"+t.day+"天",t):-1===n&&-1===r&&o>-1?(t.year="0",t.month="0",t.day=e.substring(0,o),t.age=t.day+"天",t):void 0}function d(e,t){for(var n=e.split(","),r=window.atob(n.length>1?n[1]:n[0]),o=[],a=0;a<r.length;a++)o.push(r.charCodeAt(a));var i=new Blob([new Uint8Array(o)],{type:t}),s=document.forms[0],u=new FormData(s),c=(new Date).getTime();return u.append("key",c+".png"),u.append("imageName",i),u}t.b=o,t.a=a,t.e=u,t.d=p,t.f=l,t.c=d;var f,h=n(61),g=(n.n(h),n(28)),m=n.n(g),y=n(27),v=n.n(y),x=n(31),_=n.n(x),A=n(33);n.n(A),function(){var e=v()(m.a.mark(function e(){var t;return m.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t="",e.prev=1,e.next=4,a({url:"enr2.0/sys/date",type:"post",is_failure:"first",dataType:"text"});case 4:t=e.sent,e.next=10;break;case 7:e.prev=7,e.t0=e.catch(1),t=(new Date).format("yyyy-MM-dd hh:mm:ss");case 10:return e.abrupt("return",t);case 11:case"end":return e.stop()}},e,this,[[1,7]])}))}()}).call(t,n(4))},347:function(e,t,n){n(587);var r=n(26)(n(512),n(664),null,null);e.exports=r.exports},512:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){var r=n(166),o=n.n(r),a=n(28),i=n.n(a),s=n(27),u=n.n(s),c=n(60),p=n(164),l=n(204);t.default={name:"signature_peripheral",mixins:[p.a],props:["node","saveValue"],data:function(){return{activeItem:"",layerIndex:""}},mounted:function(){function t(){return n.apply(this,arguments)}var n=u()(i.a.mark(function t(){return i.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:this.content=this.getValue,e(window).keydown(function(e){123==e.keyCode&&"function"==typeof parent.showDevTools&&parent.showDevTools()});case 2:case"end":return t.stop()}},t,this)}));return t}(),computed:o()({},n.i(c.b)(["patient","userfulWidth","showPrintCode"]),{getValue:function(){var e=this,t=this.saveValue[this.node.currNode.uniqueId]&&this.saveValue[this.node.currNode.uniqueId].filter(function(t){return t.isShow&&t.selfPropagationId==e.node.currNode.selfPropagationId});if(t){return t.reduce(function(e,t,n){return e+(n?"/":"")+(t.optionContent?t.optionContent:"")},"")||""}return""}}),methods:{importType:function(){function t(e){return r.apply(this,arguments)}var r=u()(i.a.mark(function t(r){var o,a,s,u;return i.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(o=this,layer.close(this.layerIndex),void 0!==(a=parent.ewellBrowserInfrastructure)){t.next=8;break}if(void 0!==(a=ewellBrowserInfrastructure)){t.next=8;break}return t.abrupt("return");case 8:if(1!=r){t.next=22;break}s=void 0,t.prev=10,s=a.readCard(),t.next=18;break;case 14:return t.prev=14,t.t0=t.catch(10),n.i(l.b)(t.t0.message),t.abrupt("return");case 18:u=e.extend(!0,{},o.activeItem),o.setPatient(u,s.split("_")[0]),t.next=23;break;case 22:2==r&&a.startHandwrite(function(t){var r=n.i(l.c)(JSON.parse(t).signPicture,"image/jpeg");n.i(l.a)({url:"base-service/file/uploadFiles?size=1024MB&projectName=enr&optionName=picture",dataType:"json",type:"post",cache:!1,content_type:!1,processData:!1,data:r}).then(function(t){var n=e.extend(!0,{},o.activeItem);n.inputType=1,n.imageUrl=t.length>0&&t[0].data,o.setPatient(n,"")})});case 23:case"end":return t.stop()}},t,this,[[10,14]])}));return t}(),showVerPop:function(t){this.activeItem=t,this.layerIndex=layer.open({type:1,title:"签名方式",content:e("#signature_peripheral_checkPop"),shade:0})},setPatient:function(e,t){this.tree.$emit("seleteInput",{node:this.node,item:e,value:t})},getInputType:function(e){var t=this.getOptionSaveValue(e,this.node.currNode.uniqueId);return t?t.inputType:""}},watch:{}}}.call(t,n(4))},563:function(e,t,n){t=e.exports=n(140)(!0),t.push([e.i,".lv-inline:{font-size:14px}.before{top:-999px;left:-999px}.dir-top{top:auto;bottom:30px;transform-origin:100% 100%}.explain{color:#777}.explain,.explain-error-1{line-height:15px;font-size:12px;margin:2px 0 -17px}.explain-error-1{color:#f4333c}.am-form-label{font-size:14px}","",{version:3,sources:["/Users/zhanghongsong/Ewell/JSSRMknowledge/src/components/questionTemp/common/signature_peripheral.vue"],names:[],mappings:"AACA,YACE,cAAgB,CACjB,AACD,QACE,WAAY,AACZ,WAAa,CACd,AACD,SACE,SAAU,AACV,YAAa,AACb,0BAA4B,CAC7B,AACD,SAGE,UAAY,CAEb,AAgBD,0BApBE,iBAAkB,AAClB,eAAgB,AAEhB,kBAAsB,CAsBvB,AALD,iBAGE,aAAe,CAEhB,AACD,eACE,cAAgB,CACjB",file:"signature_peripheral.vue",sourcesContent:["\n.lv-inline: {\r\n  font-size: 14px;\n}\n.before {\r\n  top: -999px;\r\n  left: -999px;\n}\n.dir-top {\r\n  top: auto;\r\n  bottom: 30px;\r\n  transform-origin: 100% 100%;\n}\n.explain {\r\n  line-height: 15px;\r\n  font-size: 12px;\r\n  color: #777;\r\n  margin: 2px 0 -17px 0;\n}\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n/*错误提示*/\n.explain-error-1 {\r\n  line-height: 15px;\r\n  font-size: 12px;\r\n  color: #F4333C;\r\n  margin: 2px 0 -17px 0;\n}\n.am-form-label {\r\n  font-size: 14px;\n}\r\n\r\n"],sourceRoot:""}])},587:function(e,t,n){var r=n(563);"string"==typeof r&&(r=[[e.i,r,""]]),r.locals&&(e.exports=r.locals);n(141)("68e11f04",r,!0)},664:function(e,t){e.exports={render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"lv-inline"},[3!=e.node.currNode.aliasType?n("div",{staticClass:"lv-item lv-title",style:{width:(e.node.currNode.style.width||220)+"px"}},[e._v("\n    "+e._s(e._f("showNodeName")(e.node.currNode))),e.showPrintCode?n("span",{staticStyle:{color:"red"},attrs:{title:e.node.currNode.uniqueId}},[e._v(e._s(e.node.currNode.uniqueId))]):e._e()]):e._e(),e._v(" "),n("div",{staticClass:"lv-inline"},e._l(e.node.currNode.optionList,function(t){return n("div",{staticClass:"lv-item"},["pageShow"!=e.mode?[1!=e.getInputType(t)?n("div",{staticClass:"am-input-unit"},[n("input",{staticClass:"input-text",style:{"padding-right":1!=t.unitList.length?"0":12*t.unitList[0].unitName.length+10+"px",width:(t.style.width?t.style.width:220)+"px","margin-left":(t.style.margin||0)+"px"},attrs:{type:"text",maxLength:t.style&&t.style.maxLength||100,readonly:"readonly"},domProps:{value:e.getValueById(t,e.node)},on:{click:function(n){n.stopPropagation(),e.showVerPop(t)}}})]):e._e(),e._v(" "),1==e.getInputType(t)?n("img",{staticStyle:{width:"200px",height:"40px"},attrs:{src:e.getOptionSaveValue(t,e.node.currNode.uniqueId).imageUrl},on:{click:function(n){n.stopPropagation(),e.showVerPop(t)}}}):e._e(),e._v(" "),e.showPrintCode?n("span",{attrs:{title:t.optionId}},[e._v(e._s(t.optionId))]):e._e()]:e._e(),e._v(" "),"pageShow"==e.mode?[1!=e.getInputType(t)?n("span",{style:{width:e.nodeWidth(t.style.width)+"px","margin-left":(t.style.margin||0)+"px"}},[e._v(e._s(e.getValue))]):e._e(),e._v(" "),1==e.getInputType(t)?n("img",{staticStyle:{width:"200px",height:"40px"},attrs:{src:e.getOptionSaveValue(t,e.node.currNode.uniqueId).imageUrl}}):e._e()]:e._e()],2)})),e._v(" "),n("div",{staticStyle:{display:"none"},attrs:{id:"signature_peripheral_checkPop"}},[n("div",{staticClass:"am-btn-area",staticStyle:{margin:"10px 20px"}},[n("a",{staticClass:"am-pop-btn am-btn-confirm",on:{click:function(t){t.stopPropagation(),e.importType(1)}}},[e._v("身份证")]),e._v(" "),n("a",{staticClass:"am-pop-btn am-btn-confirm",on:{click:function(t){t.stopPropagation(),e.importType(2)}}},[e._v("手写板")])])])])},staticRenderFns:[]}}});
//# sourceMappingURL=35.f99ba3a003090ff36369.js.map