webpackJsonp([34],{204:function(e,t,n){"use strict";(function(e){function i(e,t,n){layer.msg(e||"操作成功！",{time:t||1e3},function(){n&&n()})}function a(e,t,n){return layer.open({style:"background-color:rgba(0,0,0,0.8);color:white;max-width:70%;width:auto;border-radius: 4px;",shade:"background-color: rgba(0,0,0,0)",content:e||"error",time:t||2e3,end:function(){n&&n()}})}function r(t){return t.hideLayer=void 0==t.hideLayer||t.hideLayer,e.cookie("_token_")?t.headers={Authorization:"Bearer "+e.cookie("_token_")}:t.headers={},new w.a(function(n,r){var s="?";t.url.indexOf("?")>-1&&(s="&"),e.ajax({type:t.type||"post",url:"/"+t.url+(t.cache?"":s+"random="+Math.random()),cache:t.cache||!1,dataType:t.dataType||"json",beforeSend:function(n){t.isLogin||n.setRequestHeader("Authorization","Bearer "+e.cookie("_token_"))},contentType:t.content_type||"application/json",timeout:t.timeout||1e4,async:void 0==t.async||t.async,data:t.data||{},headers:t.headers,complete:function(){t.noHideLoading||layer.closeAll("loading")},success:function(e){t.noHideLoading||layer.closeAll("loading"),e&&(e.error_code||""==e.error_code)?r(e):n(e)},error:function(e,n,s){if(t.noHideLoading||layer.closeAll("loading"),t.hideLayer&&layer.closeAll(),"first"===t.is_failure)return void r(e);if("500"==e.status||"401"==e.status){var d=JSON.parse(e.responseText);"10000"==d.code?a("系统异常，请稍后再试！"):"20401"==d.code||"10007"==d.code?i("请重新登录！",null,function(){o()}):"invalid_token"==d.error?o():t.showFailure||a(d.message)}else{try{layer.close(p)}catch(e){}a("系统异常，请稍后再试！")}r(e)}})})}function o(){e.cookie("_id_","",{path:"/",expires:-1}),e.cookie("_un_","",{path:"/",expires:-1}),e.cookie("_ut_","",{path:"/",expires:-1}),e.cookie("_token_","",{path:"/",expires:-1}),window.sessionStorage.getItem("_transLogout_")?u():window.top.location.href=s()+"/user/html/login.html"}function s(){var t=void 0;try{t=window.top.location.href}catch(e){t=window.location.href}return d("platformUrl",t)||e.cookie("_platformUrl_")}function d(e,t){var n="",i=t||window.location.href;if(i.indexOf("?")>-1){var a=i.substring(i.indexOf("?")+1);if(e+="=",a.indexOf(e)>-1){var r=a.substr(a.indexOf(e)+e.length);-1!=r.indexOf("&")&&(r=r.substring(0,r.indexOf("&"))),n=r}}return decodeURIComponent(n)}function u(){var e=JSON.parse(window.sessionStorage.getItem("_transLogout_")),t=unescape(e.transPage),n=e.transLogoutFun;if("undefined"==typeof exec_obj){var i=document.createElement("iframe");i.id="transIframe",i.name="transIframe",i.src=t+"?transFun="+n,i.style.display="none",document.body.appendChild(i)}else exec_obj.src=t+"?transFun="+n+"&random="+Math.random();"function"==typeof parent.exec_iframe_login&&parent.exec_iframe_login()}function l(){return window.sessionStorage.getItem("_organCode_")||d("organCode")}function c(e){var t={year:"",month:"",day:"",age:""};if(!e)return t.year="adult",t.age="未知",t;e=e.replace(/个/g,"");var n=e.indexOf("岁"),i=e.indexOf("月"),a=e.indexOf("天"),r=e.substring(n+1,e.length),o=e.substring(i+1,e.length);return-1===n&&-1===i&&-1===a||n>-1&&-1===i&&-1===a&&!r?(t.year=n>-1?e.substring(0,n):e,t.age=t.year+"岁",t):n>-1&&i>-1&&-1===a&&!o||n>-1&&-1===i&&-1===a&&r?(t.year=e.substring(0,n),t.month=i>-1?e.substring(n+1,i):r,t.age=t.year+"岁"+t.month+"个月",t):n>-1&&-1===i&&a>-1?(t.year=e.substring(0,n),t.month="0",t.day=e.substring(n+1,a),t.age=t.year+"岁"+t.day+"天",t):n>-1&&i>-1&&a>-1||n>-1&&i>-1&&-1===a&&o?(t.year=e.substring(0,n),t.month=e.substring(n+1,i),t.day=a>-1?e.substring(i+1,a):o,t.age=t.year+"岁"+t.month+"个月"+t.day+"天",t):-1===n&&i>-1&&-1===a&&!o?(t.year="0",t.month=e.substring(0,i),t.age=t.month+"个月",t):-1===n&&i>-1&&a>-1||-1===n&&i>-1&&-1===a&&o?(t.year="0",t.month=e.substring(0,i),t.day=a>-1?e.substring(i+1,a):o,t.age=t.month+"个月"+t.day+"天",t):-1===n&&-1===i&&a>-1?(t.year="0",t.month="0",t.day=e.substring(0,a),t.age=t.day+"天",t):void 0}function h(e,t){for(var n=e.split(","),i=window.atob(n.length>1?n[1]:n[0]),a=[],r=0;r<i.length;r++)a.push(i.charCodeAt(r));var o=new Blob([new Uint8Array(a)],{type:t}),s=document.forms[0],d=new FormData(s),u=(new Date).getTime();return d.append("key",u+".png"),d.append("imageName",o),d}t.b=a,t.a=r,t.e=d,t.d=l,t.f=c,t.c=h;var p,f=n(61),m=(n.n(f),n(28)),g=n.n(m),y=n(27),_=n.n(y),v=n(31),w=n.n(v),x=n(33);n.n(x),function(){var e=_()(g.a.mark(function e(){var t;return g.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t="",e.prev=1,e.next=4,r({url:"enr2.0/sys/date",type:"post",is_failure:"first",dataType:"text"});case 4:t=e.sent,e.next=10;break;case 7:e.prev=7,e.t0=e.catch(1),t=(new Date).format("yyyy-MM-dd hh:mm:ss");case 10:return e.abrupt("return",t);case 11:case"end":return e.stop()}},e,this,[[1,7]])}))}()}).call(t,n(4))},349:function(e,t,n){n(585);var i=n(26)(n(514),n(661),"data-v-18188220",null);e.exports=i.exports},514:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(166),a=n.n(i),r=n(28),o=n.n(r),s=n(27),d=n.n(s),u=n(60),l=n(164),c=(n(163),n(204));t.default={name:"user",mixins:[l.a],props:["node","saveValue","mode"],data:function(){return{wardCode:n.i(c.e)("wardCode"),contentValue:""}},mounted:function(){function e(){return t.apply(this,arguments)}var t=d()(o.a.mark(function e(){return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(this.user.loginName){e.next=3;break}return e.next=3,this.setUserInfo();case 3:this.saveValue[this.node.currNode.uniqueId]||"add"==this.mode&&this.isTreeDisabled||this.setInitData();case 4:case"end":return e.stop()}},e,this)}));return e}(),computed:a()({},n.i(u.b)(["patient","user","wardCode_apply","userfulWidth"]),{getValue:function(){var e=this.node,t=e.currNode.uniqueId,n=this.saveValue[t]&&this.saveValue[t].find(function(t){return t.isShow&&t.selfPropagationId==e.currNode.selfPropagationId});return n?n.optionContent:90==e.currNode.questionType?(new Date).format(item.timeFormat):""},getValueOp:function(){var e=this;if("add"==this.mode&&this.isTreeDisabled)return"";if("CONSULTATION_WARDCODE"==this.node.currNode.childTemplateId&&"add"==this.mode)return this.wardCode_apply.value;var t=this.node.currNode.uniqueId,n=this.node.currNode.optionList[0],i=this.saveValue[t]&&this.saveValue[t].find(function(t){return t.isShow&&t.optionId==n.optionId&&t.selfPropagationId==e.node.currNode.selfPropagationId});return i?i.optionContent:(this.node.currNode.questionType,"")},isDisabled:function(){return"PAT_INDEX_NO"===this.node.currNode.childTemplateId||"ORGAN_CODE"===this.node.currNode.paperTemplateId}}),methods:a()({},n.i(u.c)(["setUserInfo"]),{setInitData:function(){var e=this,t=void 0,n=this.node.currNode,i="";"APPLY_WARDCODE"===n.childTemplateId?(t=this.user.bindedUnits.find(function(t){return t.wardCode==e.wardCode}).wardName,i=this.wardCode):"APLLY_SIGNATURE"===n.childTemplateId?(t=this.user.staffName,i=this.user.loginName):"WARDCODE"===n.childTemplateId?(t=this.user.bindedUnits.find(function(t){return t.wardCode==e.wardCode}).wardName,i=this.wardCode):"SIGNATURE"===n.childTemplateId||"RECORDER"===n.childTemplateId?(t=this.user.staffName,i=this.user.loginName):"CONSULTATION_WARDCODE"===n.childTemplateId&&(t=this.wardCode_apply.value,i=this.wardCode_apply.key);var a={node:this.node,item:n.optionList[0],value:t};a.item.optionKey=i,this.tree.$emit("seleteInput",a)},checkInputUnit:function(e,t){this.tree.$emit("seleteInput",{node:e,item:e.currNode,value:t.currentTarget.value})}}),watch:{wardCode_apply:function(){"CONSULTATION_WARDCODE"==this.node.currNode.childTemplateId&&"add"==this.mode&&this.wardCode_apply&&!this.isTreeDisabled&&this.setInitData()}}}},561:function(e,t,n){t=e.exports=n(140)(!0),t.push([e.i,"","",{version:3,sources:[],names:[],mappings:"",file:"user.vue",sourceRoot:""}])},585:function(e,t,n){var i=n(561);"string"==typeof i&&(i=[[e.i,i,""]]),i.locals&&(e.exports=i.locals);n(141)("411fec16",i,!0)},661:function(e,t){e.exports={render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"lv-inline"},[3!=e.node.currNode.aliasType?n("div",{staticClass:"lv-item lv-title",style:{"margin-left":"5px",width:e.nodeWidth(e.node.currNode.style.width)+"px"}},[e._v("\n    "+e._s(e._f("showNodeName")(e.node.currNode))+"\n  ")]):e._e(),e._v(" "),n("div",{staticClass:"lv-inline"},e._l(e.node.currNode.optionList,function(t){return n("div",{staticClass:"lv-item"},["pageShow"!==e.mode?[n("div",{staticClass:"am-input-unit"},[t.style&&1!=t.style.height?e._e():n("input",{staticClass:"input-text",style:{"padding-right":1!=t.unitList.length?"0":12*t.unitList[0].unitName.length+10+"px",width:(t.style.width||220)+"px","margin-left":(t.style.margin||0)+"px","min-width":"220px"},attrs:{type:"text",maxLength:t.style.maxLength||100,disabled:"disabled"},domProps:{value:e.getValueOp},on:{input:function(n){e.checkInputUnit(t,e.node,n)}}}),e._v(" "),t.style&&2==t.style.height?n("textarea",{staticClass:"input-text input-textarea",style:{"padding-right":0,width:(t.style.width||220)+"px","margin-left":(t.style.margin||0)+"px"},attrs:{rows:"4",maxLength:t.style.maxLength||100,disabled:e.isTreeDisabled},domProps:{value:e.getValueById(t,e.node)},on:{input:function(n){e.checkInputUnit(t,e.node,n)}}}):e._e(),e._v(" "),1==t.unitList.length?n("i",[e._v(e._s(t.unitList[0].unitName))]):e._e()]),e._v(" "),t.unitList.length>1?[e.showUnit?n("div",{staticClass:"am-btn-rdo am-ml-10"},e._l(t.unitList,function(i,a){return n("a",{class:{active:e.isUnitCodeSel(e.node.currNode,t,i.unitCode)},on:{click:function(n){e.checkRadioUnit(e.node,t,i)}}},[e._v(e._s(i.unitName))])})):e._e()]:e._e()]:e._e(),e._v(" "),"pageShow"==e.mode?[n("span",{style:{"padding-right":1!=t.unitList.length?"0":12*t.unitList[0].unitName.length+10+"px",width:e.nodeWidth(t.style.width)+"px","margin-left":(t.style.margin||0)+"px"}},[e._v(e._s(e.getValueOp))])]:e._e()],2)}))])},staticRenderFns:[]}}});
//# sourceMappingURL=34.859405cef5d78d4c445e.js.map